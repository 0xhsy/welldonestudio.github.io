"use strict";(self.webpackChunkwelldone_docs=self.webpackChunkwelldone_docs||[]).push([[6678],{3905:function(n,t,e){e.d(t,{Zo:function(){return l},kt:function(){return f}});var r=e(7294);function o(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function a(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function c(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?a(Object(e),!0).forEach((function(t){o(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function s(n,t){if(null==n)return{};var e,r,o=function(n,t){if(null==n)return{};var e,r,o={},a=Object.keys(n);for(r=0;r<a.length;r++)e=a[r],t.indexOf(e)>=0||(o[e]=n[e]);return o}(n,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(r=0;r<a.length;r++)e=a[r],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(o[e]=n[e])}return o}var i=r.createContext({}),u=function(n){var t=r.useContext(i),e=t;return n&&(e="function"==typeof n?n(t):c(c({},t),n)),e},l=function(n){var t=u(n.components);return r.createElement(i.Provider,{value:t},n.children)},d={inlineCode:"code",wrapper:function(n){var t=n.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(n,t){var e=n.components,o=n.mdxType,a=n.originalType,i=n.parentName,l=s(n,["components","mdxType","originalType","parentName"]),p=u(e),f=o,m=p["".concat(i,".").concat(f)]||p[f]||d[f]||a;return e?r.createElement(m,c(c({ref:t},l),{},{components:e})):r.createElement(m,c({ref:t},l))}));function f(n,t){var e=arguments,o=t&&t.mdxType;if("string"==typeof n||o){var a=e.length,c=new Array(a);c[0]=p;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=n,s.mdxType="string"==typeof n?n:o,c[1]=s;for(var u=2;u<a;u++)c[u]=e[u];return r.createElement.apply(null,c)}return r.createElement.apply(null,e)}p.displayName="MDXCreateElement"},1770:function(n,t,e){e.r(t),e.d(t,{assets:function(){return l},contentTitle:function(){return i},default:function(){return f},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return d}});var r=e(3117),o=e(102),a=(e(7294),e(3905)),c=["components"],s={title:"Excute Near Smart Contract",description:"Universal Provider\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub2c8\uc5b4 \ucee8\ud2b8\ub799\ud2b8 \uc2e4\ud589\ud558\uae30"},i=void 0,u={unversionedId:"tutorials/near/near-frontend",id:"tutorials/near/near-frontend",title:"Excute Near Smart Contract",description:"Universal Provider\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub2c8\uc5b4 \ucee8\ud2b8\ub799\ud2b8 \uc2e4\ud589\ud558\uae30",source:"@site/i18n/ko/docusaurus-plugin-content-docs/current/tutorials/near/near-frontend.md",sourceDirName:"tutorials/near",slug:"/tutorials/near/near-frontend",permalink:"/ko/tutorials/near/near-frontend",draft:!1,editUrl:"https://github.com/welldonestudio/welldonestudio.github.io/tree/master/docs/tutorials/near/near-frontend.md",tags:[],version:"current",frontMatter:{title:"Excute Near Smart Contract",description:"Universal Provider\ub97c \uc0ac\uc6a9\ud558\uc5ec \ub2c8\uc5b4 \ucee8\ud2b8\ub799\ud2b8 \uc2e4\ud589\ud558\uae30"},sidebar:"tutorialSidebar",previous:{title:"Deploy Near Smart Contract",permalink:"/ko/tutorials/near/near-contract"}},l={},d=[],p={toc:d};function f(n){var t=n.components,e=(0,o.Z)(n,c);return(0,a.kt)("wrapper",(0,r.Z)({},p,e,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"live",live:!0},"function increment() {\n  const [accounts, setAccounts] = React.useState(null);\n  const [txHash, setTxHash] = React.useState(null);\n  const [contractAddress, setContractAddress] = React.useState(null);\n  const [isSubmit, setIsSubmit] = React.useState(false);\n\n  async function handleGetAccount() {\n    const account = await dapp.request('near', {\n      method: 'dapp:accounts',\n    });\n    setAccounts(account['near']);\n  }\n\n  async function handleSendTransaction() {\n    const rpc = 'https://near-testnet-rpc.allthatnode.com:3030';\n    const provider = new providers.JsonRpcProvider(rpc);\n    const accessKey = await provider.query(`access_key/${accounts.address}/${accounts.pubKey}`, '');\n    const recentBlockHash = utils.serialize.base_decode(accessKey.block_hash);\n\n    const actions = [\n      transactions.functionCall(\n        'increment', // methodName\n        {}, // args\n        new BN('30000000000000'), // 30 TGas\n        new BN(0), // deposit\n      ),\n    ];\n\n    const transaction = transactions.createTransaction(\n      accounts.address, // signerId\n      utils.PublicKey.fromString(accounts.pubKey), //pubKey\n      contractAddress, // contract Id\n      accessKey.nonce + 1, // nonce\n      actions, // actions\n      recentBlockHash, // recentBlockHash\n    );\n\n    const serializedTransaction = Buffer.from(transaction.encode()).toString('base64');\n    const txHash = await dapp.request('near', {\n      method: 'dapp:sendTransaction',\n      params: [serializedTransaction],\n    });\n    setTxHash(txHash);\n  }\n\n  const handleChange = (e) => {\n    setContractAddress(e.target.value);\n  };\n\n  const handleContractId = () => {\n    if (\n      contractAddress.includes('near') ||\n      contractAddress.includes('testnet') ||\n      contractAddress.includes('devnet')\n    ) {\n      setIsSubmit(true);\n    } else {\n      alert('You have to enter valid contract address');\n    }\n  };\n\n  return (\n    <>\n      {accounts ? (\n        <>\n          {isSubmit ? (\n            <Button onClick={handleSendTransaction} type=\"button\">\n              Send a Transaction\n            </Button>\n          ) : (\n            <>\n              <Input\n                value={contractAddress}\n                onChange={handleChange}\n                placeholder=\"Deploayed Contract Address\"\n                style={{ marginRight: '8px' }}\n              />\n              <Button onClick={handleContractId} type=\"button\">\n                Set a Contract Address\n              </Button>\n            </>\n          )}\n          <ResultTooltip style={{ background: '#3B48DF' }}>\n            <b>Accounts:</b> {accounts.address}\n          </ResultTooltip>\n        </>\n      ) : (\n        <>\n          <Button onClick={handleGetAccount} type=\"button\">\n            Get Account\n          </Button>\n          <div>You have to get account first!</div>\n        </>\n      )}\n      {contractAddress && isSubmit && (\n        <ResultTooltip style={{ background: '#F4F4F4', color: 'black' }}>\n          <b>Contract Address:</b> {contractAddress}\n        </ResultTooltip>\n      )}\n      {txHash && (\n        <ResultTooltip style={{ background: '#F08080' }}>\n          <b>Transaction Hash:</b> {txHash}\n        </ResultTooltip>\n      )}\n    </>\n  );\n}\n")))}f.isMDXComponent=!0}}]);