(self.webpackChunkwelldone_docs=self.webpackChunkwelldone_docs||[]).push([[5617],{45278:function(t,e,n){"use strict";n.r(e),n.d(e,{assets:function(){return L},contentTitle:function(){return U},default:function(){return H},frontMatter:function(){return B},metadata:function(){return F},toc:function(){return P}});var r=n(83117),a=n(80102),o=n(67294),c=n(3905),s=(n(48764),n(1017)),l=n(84035),u=n(29127),i=n(53741),d=n(86062),p=n(6033),m=n(49854),f=n(25029),h=n(31126),g=n(92178),v=n(16e3),k=n(6469),b=n(89189),w=n(88e3),E=n(29183),x=n(72389),S=o.createContext(null),y=function(t){var e,r=t.children;console.log("WalletSelectorContextProvider");var a=(0,o.useState)(null),c=a[0],y=a[1],A=(0,o.useState)(null),C=A[0],N=A[1],R=(0,o.useState)([]),W=R[0],T=R[1],I=(0,x.Z)();console.log(window),console.log(window.Buffer),I&&(window.global=window,window.Buffer=window.Buffer||n(48764).Buffer);var _=(0,o.useCallback)((0,l.Z)((0,s.Z)().mark((function t(){var e,n,r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.L1)({network:"testnet",debug:!0,modules:[(0,m.X)(),(0,E.R)(),(0,f.J)(),(0,h.J)(),(0,g.t)(),(0,v.Z)(),(0,k.b)(),(0,w.r)({projectId:"test...",metadata:{name:"NEAR Wallet Selector",description:"Example dApp used by NEAR Wallet Selector",url:"https://github.com/near/wallet-selector",icons:["https://avatars.githubusercontent.com/u/37784886"]}}),(0,b.i)({url:"wss://relay.nightly.app/app",appMetadata:{additionalInfo:"",application:"NEAR Wallet Selector",description:"Example dApp used by NEAR Wallet Selector",icon:"https://near.org/wp-content/uploads/2020/09/cropped-favicon-192x192.png"}})]});case 2:e=t.sent,n=(0,p.D)(e,{contractId:"mycontract.myaccount8.testnet"}),r=e.store.getState(),T(r.accounts),window.selector=e,window.modal=n,y(e),N(n);case 10:case"end":return t.stop()}}),t)}))),[]);if((0,o.useEffect)((function(){_().catch((function(t){console.error(t),alert("Failed to initialise wallet selector")}))}),[_]),(0,o.useEffect)((function(){if(c){var t=c.store.observable.pipe((0,u.U)((function(t){return t.accounts})),(0,i.x)()).subscribe((function(t){console.log("Accounts Update",t),T(t)}));return function(){return t.unsubscribe()}}}),[c]),!c||!C)return null;var Z=(null==(e=W.find((function(t){return t.active})))?void 0:e.accountId)||null;return o.createElement(S.Provider,{value:{selector:c,modal:C,accounts:W,accountId:Z}},r)};var A=n(68447),C="fadeMeAnimation_XH_X",N=A.utils.format.parseNearAmount("0.00000000003"),R=function(t){return o.createElement("button",(0,r.Z)({},t,{style:Object.assign({borderRadius:"8px",padding:"10px 16px",color:"white",background:"#009400",border:"none",cursor:"pointer",fontSize:"14px",marginBottom:"4px"},t.style)}))},W=function(t){return o.createElement("div",(0,r.Z)({},t,{className:C,style:Object.assign({width:"100%",borderRadius:"8px",padding:"16px",color:"white",marginTop:"8px"},t.style)}))},T=function(){var t=function(){var t=(0,o.useContext)(S);if(!t)throw new Error("useWalletSelector must be used within a WalletSelectorContextProvider");return t}(),e=t.selector,n=t.modal,r=t.accounts,a=t.accountId,c=(0,o.useState)(null),u=c[0],i=c[1],d=(0,o.useState)(!1),p=d[0],m=d[1],f=(0,o.useState)(""),h=f[0],g=f[1],v=(0,o.useState)(),k=v[0],b=v[1],w=(0,o.useState)(),E=(w[0],w[1],(0,o.useCallback)((0,l.Z)((0,s.Z)().mark((function t(){var n,r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",null);case 2:return n=e.options.network,r=new A.providers.JsonRpcProvider({url:n.nodeUrl}),t.abrupt("return",r.query({request_type:"view_account",finality:"final",account_id:a}).then((function(t){return Object.assign({},t,{account_id:a})})));case 5:case"end":return t.stop()}}),t)}))),[a,e.options]));(0,o.useEffect)((function(){if(!a)return i(null);m(!0),E().then((function(t){i(t),m(!1)}))}),[a,E]);var x=function(){var t=(0,l.Z)((0,s.Z)().mark((function t(){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.wallet();case 2:t.sent.signOut().catch((function(t){console.log("Failed to sign out"),console.error(t)}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=function(){var t=(0,l.Z)((0,s.Z)().mark((function t(){var n,r,a,o,c,l;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.options.network,r=e.store.getState(),a=r.contract,o=new A.providers.JsonRpcProvider({url:n.nodeUrl}),t.next=5,o.query({request_type:"call_function",account_id:a.contractId,method_name:"get_num",args_base64:"e30=",finality:"optimistic"});case 5:c=t.sent,l=JSON.parse(Buffer.from(c.result).toString()),b(l);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),C=(0,o.useCallback)((0,l.Z)((0,s.Z)().mark((function t(){var n,r,o,c;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.store.getState(),r=n.contract,t.next=3,e.wallet();case 3:return o=t.sent,t.next=6,o.signAndSendTransaction({signerId:a,receiverId:r.contractId,actions:[{type:"FunctionCall",params:{methodName:"increment",args:{count:1},gas:N,deposit:A.utils.format.parseNearAmount("0")}}]}).catch((function(t){throw alert("Failed to sending transaction"),console.log("Failed to sending transaction"),t}));case 6:c=t.sent,g(c.transaction.hash);case 8:case"end":return t.stop()}}),t)}))),[e,a]);return p?null:u?o.createElement(o.Fragment,null,o.createElement("div",null,o.createElement(W,{style:{background:"#3B48DF",margin:"10px"}},o.createElement("b",null,"Account:")," ",a),k&&o.createElement(W,{style:{background:"#F08080",margin:"10px"}},o.createElement("b",null,"Count:")," ",k),h&&o.createElement(W,{style:{background:"#F4F4F4",color:"black",margin:"10px"}},o.createElement("b",null,"Transaction Hash:")," ",h),o.createElement(R,{style:{margin:"10px"},onClick:x},"Log out"),o.createElement(R,{style:{marginRight:"10px"},onClick:function(){n.show()}},"Switch Wallet"),r.length>1&&o.createElement(R,{onClick:function(){var t=r.findIndex((function(t){return t.accountId===a})),n=t<r.length-1?t+1:0,o=r[n].accountId;e.setActiveAccount(o),alert("Switched account to "+o)}},"Switch Account"),o.createElement(R,{style:{marginRight:"10px"},onClick:y},"Get Count"),o.createElement(R,{style:{background:"#009400"},onClick:C},"Send a Transaction"))):o.createElement(o.Fragment,null,o.createElement("div",null,o.createElement(R,{onClick:function(){n.show()}},"Log in")))},I=function(){return o.createElement(y,null,o.createElement(T,null))},_=n(91262),Z=["components"],B={title:"Execute the Contract",description:"Execute the Contract using Universal Provider"},U="Execute the Contract in NEAR using Universal Provider",F={unversionedId:"tutorials/near/rust/near-frontend",id:"tutorials/near/rust/near-frontend",title:"Execute the Contract",description:"Execute the Contract using Universal Provider",source:"@site/i18n/ko/docusaurus-plugin-content-docs/current/tutorials/near/rust/near-frontend.mdx",sourceDirName:"tutorials/near/rust",slug:"/tutorials/near/rust/near-frontend",permalink:"/ko/tutorials/near/rust/near-frontend",draft:!1,editUrl:"https://github.com/welldonestudio/welldonestudio.github.io/tree/master/docs/tutorials/near/rust/near-frontend.mdx",tags:[],version:"current",frontMatter:{title:"Execute the Contract",description:"Execute the Contract using Universal Provider"},sidebar:"tutorialSidebar",previous:{title:"Rust Smart Contract in NEAR",permalink:"/ko/tutorials/near/rust/near-contract"},next:{title:"NEAR Ecosystem",permalink:"/ko/tutorials/near-ecosystem/"}},L={},P=[{value:"Introduction",id:"introduction",level:2},{value:"Using Universal Provider",id:"using-universal-provider",level:2},{value:"Using Wallet Selector",id:"using-wallet-selector",level:2}],D={toc:P};function H(t){var e=t.components,n=(0,a.Z)(t,Z);return(0,c.kt)("wrapper",(0,r.Z)({},D,n,{components:e,mdxType:"MDXLayout"}),(0,c.kt)("h1",{id:"execute-the-contract-in-near-using-universal-provider"},"Execute the Contract in NEAR using Universal Provider"),(0,c.kt)("div",null,(0,c.kt)("span",{className:"author-sm"},"September 8, 2022"),(0,c.kt)("div",{className:"author-div"},(0,c.kt)("div",{className:"author-avatars"},(0,c.kt)("a",{href:"https://github.com/Yoon-Suji",target:"_blank"},(0,c.kt)("img",{src:"https://avatars.githubusercontent.com/u/70956926?v=4"}))),(0,c.kt)("div",null,(0,c.kt)("span",{className:"author-name"},"Suji Yoon"),(0,c.kt)("br",null),(0,c.kt)("span",{className:"author-sm"},"Software Engineer, DSRV ")))),(0,c.kt)("h2",{id:"introduction"},"Introduction"),(0,c.kt)("p",null,"\uc55e\uc120 \ud29c\ud1a0\ub9ac\uc5bc\uc5d0\uc11c \uc6b0\ub9ac\ub294 WELLDONE Code\ub97c \uc774\uc6a9\ud574\uc11c NEAR\uc5d0\uc11c Rust\ub97c \uc0ac\uc6a9\ud558\uc5ec \uac04\ub2e8\ud55c \uce74\uc6b4\ud130 \ucee8\ud2b8\ub799\ud2b8\ub97c \uc791\uc131\ud558\uace0, \ubc30\ud3ec\ud558\uace0, \uc2e4\ud589\ud574\ubcf4\uc558\uc2b5\ub2c8\ub2e4.\n\uc774\ubc88 \ud29c\ud1a0\ub9ac\uc5bc\uc5d0\uc11c\ub294 WELLDONE Wallet\uc744 \uc774\uc6a9\ud574\uc11c \ud504\ub860\ud2b8\uc5d4\ub4dc\uc640 \uc2a4\ub9c8\ud2b8 \ucee8\ud2b8\ub799\ud2b8\uac00 \ud1b5\uc2e0\ud558\ub294 \ubc29\ubc95\uc744 \uc2e4\uc2b5\ud574\ubcf4\uaca0\uc2b5\ub2c8\ub2e4."),(0,c.kt)("h2",{id:"using-universal-provider"},"Using Universal Provider"),(0,c.kt)("b",null,"Universal Provider"),"\ub294 WELLDONE Wallet\uacfc \ud1b5\uc2e0\ud558\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\ub85c \ube14\ub85d\uccb4\uc778 \ubcc4\ub85c \ub2e4\ub978 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub4e4\uc758 \uc694\uad6c\uc0ac\ud56d\uc744 \ucd94\uc0c1\ud654\ud558\uc5ec \uc81c\uacf5\ud569\ub2c8\ub2e4. ",(0,c.kt)("b",null,"Universal Provider"),"\ub97c \uc0ac\uc6a9\ud55c\ub2e4\uba74 \uba40\ud2f0 \uccb4\uc778\uc0c1\uc5d0\uc11c dApp\uc744 \uac1c\ubc1c\ud558\ub294 \ube4c\ub354\ub4e4\uc774 \uac01\uae30 \ub2e4\ub978 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \ub530\ub85c \uad00\ub9ac\ud560 \ud544\uc694\uac00 \uc5c6\uc5b4 \uac1c\ubc1c\uc5d0 \uc628\uc804\ud788 \uc9d1\uc911\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.",(0,c.kt)("b",null,"Universal Provider"),"\uc5d0 \ub300\ud55c \ub354 \uc790\uc138\ud55c ",(0,c.kt)("a",{href:"https://docs.welldonestudio.io/ko/wallet/developer-guide/provider-api/how-we-wrap-for-multichain",target:"_blank"},"\uc124\uba85"),"\uacfc ",(0,c.kt)("a",{href:"https://docs.welldonestudio.io/ko/wallet/developer-guide/provider-api/method",target:"_blank"},"\uc0ac\uc6a9\ubc95"),"\uc740 \ub9c1\ud06c\ub97c \ucc38\uace0\ud574 \uc8fc\uc138\uc694.",(0,c.kt)("br",null),(0,c.kt)("br",null),"\uc544\ub798 \ucf54\ub4dc\ub294 \uc55e\uc120 \ud29c\ud1a0\ub9ac\uc5bc\uc5d0\uc11c \ubc30\ud3ec\ud55c \ucee8\ud2b8\ub799\ud2b8\uc758 ",(0,c.kt)("code",null,"increment")," \uba85\ub839\uc5b4\ub97c \uc2e4\ud589\ud558\ub294 \uc608\uc81c\uc785\ub2c8\ub2e4. \uba3c\uc800 ",(0,c.kt)("code",null,"Get Account")," \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc5ec WELLDONE Wallet\uacfc \uc5f0\uacb0\ud55c \ud6c4, \uc790\uc2e0\uc774 \ubc30\ud3ec\ud55c \ucee8\ud2b8\ub799\ud2b8\uc758 ID\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694. \ud2b8\ub79c\uc7ad\uc158 \ud574\uc2dc\ub97c ",(0,c.kt)("a",{href:"https://explorer.testnet.near.org/",target:"_blank"},"\uc775\uc2a4\ud50c\ub85c\ub7ec"),"\uc5d0\uc11c \uac80\uc0c9\ud558\uc5ec \uc131\uacf5 \uc5ec\ubd80\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.",(0,c.kt)("br",null),(0,c.kt)("br",null),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"live",live:!0},"function increment() {\n  const [accounts, setAccounts] = React.useState(null);\n  const [txHash, setTxHash] = React.useState(null);\n  const [contractAddress, setContractAddress] = React.useState(null);\n  const [isSubmit, setIsSubmit] = React.useState(false);\n\n  async function handleGetAccount() {\n    const account = await dapp.request('near', {\n      method: 'dapp:accounts',\n    });\n    setAccounts(account['near']);\n  }\n\n  async function handleSendTransaction() {\n    const rpc = 'https://near-testnet-rpc.allthatnode.com:3030';\n    const provider = new providers.JsonRpcProvider(rpc);\n    const accessKey = await provider.query(`access_key/${accounts.address}/${accounts.pubKey}`, '');\n    const recentBlockHash = utils.serialize.base_decode(accessKey.block_hash);\n\n    const actions = [\n      transactions.functionCall(\n        'increment', // methodName\n        {}, // args\n        new BN('30000000000000'), // 30 TGas\n        new BN(0), // deposit\n      ),\n    ];\n\n    const transaction = transactions.createTransaction(\n      accounts.address, // signerId\n      utils.PublicKey.fromString(accounts.pubKey), //pubKey\n      contractAddress, // contract Id\n      accessKey.nonce + 1, // nonce\n      actions, // actions\n      recentBlockHash, // recentBlockHash\n    );\n\n    const serializedTransaction = Buffer.from(transaction.encode()).toString('base64');\n    const txHash = await dapp.request('near', {\n      method: 'dapp:sendTransaction',\n      params: [serializedTransaction],\n    });\n    setTxHash(txHash);\n  }\n\n  const handleChange = (e) => {\n    setContractAddress(e.target.value);\n  };\n\n  const handleContractId = () => {\n    if (\n      contractAddress.includes('near') ||\n      contractAddress.includes('testnet') ||\n      contractAddress.includes('devnet')\n    ) {\n      setIsSubmit(true);\n    } else {\n      alert('You have to enter valid contract address');\n    }\n  };\n\n  return (\n    <>\n      {accounts ? (\n        <>\n          {isSubmit ? (\n            <Button onClick={handleSendTransaction} type=\"button\">\n              Send a Transaction\n            </Button>\n          ) : (\n            <>\n              <Input\n                value={contractAddress}\n                onChange={handleChange}\n                placeholder=\"Deploayed Contract Address\"\n                style={{ marginRight: '8px' }}\n              />\n              <Button onClick={handleContractId} type=\"button\">\n                Set a Contract Address\n              </Button>\n            </>\n          )}\n          <ResultTooltip style={{ background: '#3B48DF' }}>\n            <b>Accounts:</b> {accounts.address}\n          </ResultTooltip>\n        </>\n      ) : (\n        <>\n          <Button onClick={handleGetAccount} type=\"button\">\n            Get Account\n          </Button>\n          <div>You have to get account first!</div>\n        </>\n      )}\n      {contractAddress && isSubmit && (\n        <ResultTooltip style={{ background: '#F4F4F4', color: 'black' }}>\n          <b>Contract Address:</b> {contractAddress}\n        </ResultTooltip>\n      )}\n      {txHash && (\n        <ResultTooltip style={{ background: '#F08080' }}>\n          <b>Transaction Hash:</b> {txHash}\n        </ResultTooltip>\n      )}\n    </>\n  );\n}\n")),(0,c.kt)("h2",{id:"using-wallet-selector"},"Using Wallet Selector"),(0,c.kt)("p",null,(0,c.kt)("a",{href:"https://github.com/near/wallet-selector",target:"_blank"},"Wallet Selector")," ","\ub294 NEAR\uc5d0\uc11c \uacf5\uc2dd\uc801\uc73c\ub85c \uc9c0\uc6d0\ud558\ub294 \ud504\ub85c\uc81d\ud2b8\ub85c, NEAR \ud504\ub85c\ud1a0\ucf5c\uc744 \uc9c0\uc6d0\ud558\ub294 \ub2e4\uc591\ud55c \uc9c0\uac11\uacfc dApp \uc0ac\uc6a9\uc790\uac00 \ud3b8\ud558\uac8c \uc18c\ud1b5\ud560 \uc218 \uc788\ub3c4\ub85d \uc9c0\uac11\uc758 \uc8fc\uc694 \uae30\ub2a5\uc744 \ucd94\uc0c1\ud654\ud558\uc5ec \uc81c\uacf5\ud569\ub2c8\ub2e4. \uc0ac\uc6a9\uc790\ub294 \uc6d0\ud558\ub294 \uc9c0\uac11\uc744 \uc120\ud0dd\ud55c \ud6c4, Wallet Selector\uc5d0\uc11c \uc81c\uacf5\ud558\ub294 \ucd94\uc0c1\ud654 \uba54\uc18c\ub4dc\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc9c0\uac11\uacfc \ud1b5\uc2e0\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. ",(0,c.kt)("br",null),(0,c.kt)("code",null,"Log in")," \ubc84\ud2bc\uc744 \ub20c\ub7ec ",(0,c.kt)("b",null,"WELLDONE Wallet"),"\uc5d0 \uc5f0\uacb0\ud55c \ud6c4, ",(0,c.kt)("code",null,"Send a Transaction")," \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc5ec",(0,c.kt)("code",null,"increment")," \uba54\uc18c\ub4dc\ub97c \uc2e4\ud589\uc2dc\ucf1c \ubcf4\uc138\uc694. ",(0,c.kt)("code",null,"Get Count")," \ubc84\ud2bc\uc744 \ub204\ub974\uba74 \ucee8\ud2b8\ub799\ud2b8\uc758 \ud604\uc7ac \uce74\uc6b4\ud2b8 \uac12\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4."),(0,c.kt)(_.Z,{mdxType:"BrowserOnly"},(function(){return(0,c.kt)(I,{mdxType:"WalletSelector"})})),(0,c.kt)("p",null,(0,c.kt)("b",null,"WELLDONE Wallet"),"\uc740 Wallet Selector\uac00 \uacf5\uc2dd\uc801\uc73c\ub85c \uc9c0\uc6d0\ud558\ub294 \uc9c0\uac11\uc785\ub2c8\ub2e4. Wallet Selector\ub97c \uc0ac\uc6a9\ud558\uc5ec \ud2b8\ub79c\uc7ad\uc158\uc744 \ubcf4\ub0b4\ub294 \uc804\uccb4 \ucf54\ub4dc\uac00 \uad81\uae08\ud558\ub2e4\uba74"," ",(0,c.kt)("a",{href:"https://github.com/welldonestudio/welldonestudio.github.io/tree/feat/tutorial/src/components/WalletSelector",target:"_blank"},"\uae43\ud5c8\ube0c"),"\ub97c \ud655\uc778\ud574\uc8fc\uc138\uc694."))}H.isMDXComponent=!0},59488:function(){},35883:function(){},98971:function(){},46601:function(){},55024:function(){}}]);