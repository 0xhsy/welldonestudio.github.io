"use strict";(self.webpackChunkwelldone_docs=self.webpackChunkwelldone_docs||[]).push([[4771],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return h}});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var r=a.createContext({}),u=function(e){var t=a.useContext(r),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},l=function(e){var t=u(e.components);return a.createElement(r.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,r=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),p=u(n),h=o,m=p["".concat(r,".").concat(h)]||p[h]||d[h]||s;return n?a.createElement(m,c(c({ref:t},l),{},{components:n})):a.createElement(m,c({ref:t},l))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,c=new Array(s);c[0]=p;var i={};for(var r in t)hasOwnProperty.call(t,r)&&(i[r]=t[r]);i.originalType=e,i.mdxType="string"==typeof e?e:o,c[1]=i;for(var u=2;u<s;u++)c[u]=n[u];return a.createElement.apply(null,c)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},21136:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return r},default:function(){return h},frontMatter:function(){return i},metadata:function(){return u},toc:function(){return d}});var a=n(83117),o=n(80102),s=(n(67294),n(3905)),c=["components"],i={title:"Standard Account",description:"Learning about Aptos Standard Account"},r="Standard Account",u={unversionedId:"tutorials/aptos-account/account",id:"tutorials/aptos-account/account",title:"Standard Account",description:"Learning about Aptos Standard Account",source:"@site/docs/tutorials/aptos-account/account.md",sourceDirName:"tutorials/aptos-account",slug:"/tutorials/aptos-account/account",permalink:"/tutorials/aptos-account/account",draft:!1,editUrl:"https://github.com/welldonestudio/welldonestudio.github.io/tree/master/docs/tutorials/aptos-account/account.md",tags:[],version:"current",frontMatter:{title:"Standard Account",description:"Learning about Aptos Standard Account"},sidebar:"tutorialSidebar",previous:{title:"APTOS Account Model",permalink:"/tutorials/aptos-account/"},next:{title:"APTOS Move Prover",permalink:"/tutorials/aptos-move-prover/"}},l={},d=[{value:"Introduction",id:"introduction",level:2},{value:"<strong>Standard Account</strong>",id:"standard-account-1",level:2},{value:"<strong>Account Creation and Management</strong>",id:"account-creation-and-management",level:3},{value:"Authentication Key",id:"authentication-key",level:3},{value:"<strong>Multisig Account</strong>",id:"multisig-account",level:3},{value:"<strong>Conclusion</strong>",id:"conclusion",level:2},{value:"Reference",id:"reference",level:3}],p={toc:d};function h(e){var t=e.components,i=(0,o.Z)(e,c);return(0,s.kt)("wrapper",(0,a.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"standard-account"},"Standard Account"),(0,s.kt)("div",null,(0,s.kt)("span",{className:"author-sm"},"November 29, 2023"),(0,s.kt)("div",{className:"author-div"},(0,s.kt)("div",{className:"author-avatars"},(0,s.kt)("a",{href:"https://github.com/0xhsy",target:"_blank"},(0,s.kt)("img",{src:"https://avatars.githubusercontent.com/u/102006034?v=4"}))),(0,s.kt)("div",null,(0,s.kt)("span",{className:"author-name"},"Sooyoung Hyun"),(0,s.kt)("br",null),(0,s.kt)("span",{className:"author-sm"},"Lead Software Engineer, DSRV ")))),(0,s.kt)("h2",{id:"introduction"},"Introduction"),(0,s.kt)("p",null,"In the Aptos blockchain, the account model is a key element for managing users' digital assets and smart contracts. There are three types of accounts in Aptos: standard accounts with typical key pairs, resource accounts which are standalone accounts without private keys used by developers, and objects which are complex sets of resources stored at a single address. Each of these types of accounts has its unique characteristics and use cases. In this article, we will primarily discuss the special features of the Standard Account."),(0,s.kt)("h2",{id:"standard-account-1"},(0,s.kt)("strong",{parentName:"h2"},"Standard Account")),(0,s.kt)("h3",{id:"account-creation-and-management"},(0,s.kt)("strong",{parentName:"h3"},"Account Creation and Management")),(0,s.kt)("p",null,"In the Aptos blockchain, the state of each account is composed of two main elements: Move modules and Move resources."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Move Modules"),": These include code, such as declarations of types or procedures, but do not contain data. Move modules define the rules for updating the global state of the Aptos blockchain."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("strong",{parentName:"li"},"Move Resources"),": On the other hand, Move resources contain data but no code. Each value of Move resources is of a type declared in some module published on the Aptos blockchain.")),(0,s.kt)("p",null,"Accounts in Aptos are created on-chain, and users can create new accounts through wallets. However, actual activation on-chain requires a separate transaction. As seen in the images below, an account is created in the wallet, but it is not found in the explorer."),(0,s.kt)("img",{src:n(89293).Z,alt:"wallet-create-account",style:{width:"300px",marginBottom:"20px"}}),(0,s.kt)("img",{src:n(15493).Z,alt:"explorer-no-account"}),(0,s.kt)("p",null,"Here, ",(0,s.kt)("strong",{parentName:"p"},"we use a faucet for account activation.")," This allows users to activate their accounts on-chain and start transactions on the actual Aptos network. The Aptos official documentation describes this as follows:"),(0,s.kt)("admonition",{type:"note"},(0,s.kt)("p",{parentName:"admonition"},"The Aptos framework supports implicitly creating accounts when transferring Aptos coin via ",(0,s.kt)("inlineCode",{parentName:"p"},"aptos_account::transfer")," or explicitly via ",(0,s.kt)("inlineCode",{parentName:"p"},"aptos_account::create_account"),".")),(0,s.kt)("img",{src:n(63252).Z,alt:"wallet-faucet",style:{width:"300px",marginBottom:"20px"}}),(0,s.kt)("img",{src:n(99810).Z,alt:"explorer-account-info"}),(0,s.kt)("p",null,"An account activated through the faucet can be seen in the Aptos Explorer with key information, including the account address, sequence number, and authentication key."),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"guid")," is a globally unique identifier generated based on the sender's address and counter, while the account's ",(0,s.kt)("inlineCode",{parentName:"p"},"sequence_number")," indicates the number of transactions submitted and committed on-chain from that account. We will explore ",(0,s.kt)("inlineCode",{parentName:"p"},"authentication_key")," in more detail."),(0,s.kt)("h3",{id:"authentication-key"},"Authentication Key"),(0,s.kt)("p",null,"The authentication key is an important element related to account security. This key is set at the time of account creation and can be changed as needed. That is, users can change the authentication key periodically for security reasons. If the private key of an account has been exposed or is likely to have been exposed, you can safely protect the account by changing the private key and authentication key while maintaining the original account address."),(0,s.kt)("admonition",{type:"note"},(0,s.kt)("p",{parentName:"admonition"},"In Aptos, an authentication key is created from the public key in the private-public key pair, mapped to the account address, and then mapped on-chain, allowing verification of the account and authentication key.")),(0,s.kt)("p",null,"Let's see an example. We will change the authentication key for the account we just created."),(0,s.kt)("img",{src:n(65339).Z,alt:"key-rotate",style:{marginBottom:"20px"}}),(0,s.kt)("p",null,"The rotate-key feature of aptos-cli was utilized to change the authentication key. Subsequently, through the explorer, it was confirmed that the authentication key for the original account, 0x28a0\u20262c1, had been changed."),(0,s.kt)("img",{src:n(31805).Z,alt:"change-key-info",style:{marginBottom:"20px"}}),(0,s.kt)("p",null,"Since the previous key, prior to the change, is stored in the wallet, if a transaction is signed and sent using this old key, it will naturally fail."),(0,s.kt)("img",{src:n(90560).Z,alt:"fail-tx",style:{width:"300px",marginBottom:"20px"}}),(0,s.kt)("p",null,"Let's examine an example from the ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/aptos-labs/aptos-core/blob/main/ecosystem/typescript/sdk/examples/typescript-esm/rotate_key.ts"},"code")," in the aptos-core repository."),(0,s.kt)("p",null,"This code utilizes the Aptos blockchain network to create two new accounts and then activates them using the faucet, followed by rotating the authentication key of one of the accounts. The primary components and process used are as follows:"),(0,s.kt)("p",null,"The ",(0,s.kt)("inlineCode",{parentName:"p"},"AptosAccount")," class is used to create two new accounts named Alice and Bob. Then, the ",(0,s.kt)("inlineCode",{parentName:"p"},"FaucetClient")," is employed to transfer funds to these two accounts."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},"// :!:>create_accounts\n  const alice = new AptosAccount();\n  const bob = new AptosAccount(); // <:!:create_accounts\n\n  await faucetClient.fundAccount(alice.address(), 1 * Math.pow(10, APTOS_COIN_DECIMALS));\n  await faucetClient.fundAccount(bob.address(), 1 * Math.pow(10, APTOS_COIN_DECIMALS));\n")),(0,s.kt)("p",null,"Alice's authentication key is changed to Bob's secret key."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},"const response = await provider.aptosClient.rotateAuthKeyEd25519(alice, bob.signingKey.secretKey); // <:!:rotate_key\n")),(0,s.kt)("p",null,"After the authentication key is changed, a new instance of Alice's account is created using the new private key and the existing address of Alice"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-tsx"},"// We must create a new instance of AptosAccount because the private key has changed.\n  const aliceNew = new AptosAccount(\n    bob.signingKey.secretKey,\n    alice.address(), // NOTE: Without this argument, this would be bob, not aliceNew. You must specify the address since the private key matches multiple accounts now\n  );\n")),(0,s.kt)("p",null,"Below are the execution results. It can be observed that Alice's authentication key has been changed to Bob's."),(0,s.kt)("img",{src:n(48710).Z,alt:"ts-example-key-rotation"}),(0,s.kt)("h3",{id:"multisig-account"},(0,s.kt)("strong",{parentName:"h3"},"Multisig Account")),(0,s.kt)("p",null,"In the Aptos blockchain, the Multisig (Multisignature) feature is a crucial mechanism for managing transactions that require the approval of multiple entities (owners). This feature enhances security and is especially useful in situations requiring joint decisions. For instance, it can be used in organizational fund management or executing significant contracts that require the approval of multiple stakeholders."),(0,s.kt)("p",null,"We will explore how to implement a multisig account using the ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/aptos-labs/aptos-core/blob/main/ecosystem/typescript/sdk/examples/typescript/multisig_account.ts"},"multisig_account.ts")," script. This example covers the creation of a multisig account, addition and removal of administrators, and changing the signature threshold settings."),(0,s.kt)("p",null,"Here is a scenario and an explanation of the main functions in the example code."),(0,s.kt)("p",null,"Aptos accounts are created for three owners (",(0,s.kt)("inlineCode",{parentName:"p"},"owner1"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"owner2"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"owner3"),"), and funds are provided to each account."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},"const owner1 = new AptosAccount();\nconst owner2 = new AptosAccount();\nconst owner3 = new AptosAccount();\nawait faucetClient.fundAccount(owner1.address(), 100_000_000);\nawait faucetClient.fundAccount(owner2.address(), 100_000_000);\nawait faucetClient.fundAccount(owner3.address(), 100_000_000);\n")),(0,s.kt)("p",null,"Multisig Account Setup (2-of-3): A 2-of-3 multisig account is created using owner1. This type of account requires the approval of two out of three owners."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'const payload: Gen.ViewRequest = {\n  function: "0x1::multisig_account::get_next_multisig_account_address",\n  arguments: [owner1.address().hex()],\n};\nconst multisigAddress = (await client.view(payload))[0] as string;\n')),(0,s.kt)("p",null,"Funding the Multisig Account: Funds are provided to the created multisig account."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},"await faucetClient.fundAccount(multisigAddress, 100_000_000);\n")),(0,s.kt)("p",null,"Creating and Executing Multisig Transactions: Transactions for transferring coins using the multisig account are created and executed."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'const recipient = new AptosAccount();\nconst transferTxPayload = new MultiSigTransactionPayload(\n  EntryFunction.natural(\n    "0x1::aptos_account", "transfer", [], \n    [BCS.bcsToBytes(AccountAddress.fromHex(recipient.address())), BCS.bcsSerializeUint64(1_000_000)]\n  ),\n);\nconst createMultisigTx = await client.generateTransaction(owner2.address(), /*...*/);\nawait client.generateSignSubmitWaitForTransaction(owner2, createMultisigTx.payload);\n')),(0,s.kt)("p",null,"Executing Multisig Transactions (Using Payload Hash): Another multisig transaction is created and executed using the payload's hash. This process means creating and executing transactions in a safer and more efficient way using the hash of the payload."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'const transferTxPayloadHash = sha3Hash.create();\ntransferTxPayloadHash.update(BCS.bcsToBytes(transferTxPayload));\nconst createMultisigTxWithHash = await client.generateTransaction(\n  owner2.address(), \n  {\n    function: "0x1::multisig_account::create_transaction_with_hash",\n    /* ... */\n  }\n);\n')),(0,s.kt)("p",null,"Managing Multisig Account Owners: The process of adding new owners to the multisig account and then removing them is carried out."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'const addOwnerPayload = new MultiSigTransactionPayload(\n  EntryFunction.natural(\n    "0x1::multisig_account", "add_owner", [], \n    [BCS.bcsToBytes(AccountAddress.fromHex(owner_4.address()))]\n  ),\n);\nconst removeOwnerPayload = new MultiSigTransactionPayload(\n  EntryFunction.natural(\n    "0x1::multisig_account", "remove_owner", [], \n    [BCS.bcsToBytes(AccountAddress.fromHex(owner_4.address()))]\n  ),\n);\n')),(0,s.kt)("p",null,"Changing Signature Threshold: The signature threshold of the multisig account is changed to 3-of-3."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'const changeSigThresholdPayload = new MultiSigTransactionPayload(\n  EntryFunction.natural(\n    "0x1::multisig_account", "update_signatures_required", [], \n    [BCS.bcsSerializeUint64(3)]\n  ),\n);\n')),(0,s.kt)("p",null,"Reject and Approve Function (rejectAndApprove): Implements the process of rejecting or approving multisig transactions."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'const rejectAndApprove = async (client, owner1, owner2, multisigAddress, transactionId) => {\n  let rejectTx = await client.generateTransaction(\n    owner1.address(), \n    {\n      function: "0x1::multisig_account::reject_transaction",\n      arguments: [multisigAddress, transactionId],\n      /* ... */\n    }\n  );\n  let approveTx = await client.generateTransaction(\n    owner2.address(), \n    {\n      function: "0x1::multisig_account::approve_transaction",\n      arguments: [multisigAddress, transactionId],\n      /* ... */\n    }\n  );\n};\n')),(0,s.kt)("p",null,"Functions to Check the Number of Owners and Signature Threshold (getNumberOfOwners, getSignatureThreshold): Implements the feature to check the number of owners and the signature threshold of the multisig account."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'const getNumberOfOwners = async (client, multisigAddress) => {\n  const multisigAccountResource = await client.getAccountResource(\n    multisigAddress, "0x1::multisig_account::MultisigAccount"\n  );\n  return Number((multisigAccountResource.data as any).owners.length);\n};\nconst getSignatureThreshold = async (client, multisigAddress) => {\n  const multisigAccountResource = await client.getAccountResource(\n    multisigAddress, "0x1::multisig_account::MultisigAccount"\n  );\n  return Number((multisigAccountResource.data as any).num_signatures_required);\n};\n')),(0,s.kt)("p",null,"Below are the execution results."),(0,s.kt)("img",{src:n(4608).Z,alt:"multisig-account"}),(0,s.kt)("p",null,"Aptos's multisig feature enhances the core advantages of blockchain technology, decentralized trust, and security. It allows users to secure higher levels of security in various areas, such as asset management and contract execution. This multisig mechanism plays a crucial role in the development of decentralized applications(DApps) as one of the various features offered by the Aptos blockchain."),(0,s.kt)("h2",{id:"conclusion"},(0,s.kt)("strong",{parentName:"h2"},"Conclusion")),(0,s.kt)("p",null,"Through this article, we have explored the account model of the Aptos blockchain, particularly focusing on Key rotation and Multisig Account features. The unique functions and user-friendly account management system of the Aptos blockchain play an important role in the advancement of blockchain technology and its wider application. This knowledge provides valuable insights into the future of blockchain technology and its application in various application developments, helping us to actively participate in the innovative journey as members of the Aptos ecosystem."),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"reference"},"Reference"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://aptos.dev/"},"https://aptos.dev/")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://github.com/aptos-labs/aptos-core"},"https://github.com/aptos-labs/aptos-core")))}h.isMDXComponent=!0},89293:function(e,t,n){t.Z=n.p+"assets/images/account1-d64addd04a7027733858a5e5fb9a1731.png"},15493:function(e,t,n){t.Z=n.p+"assets/images/explorer1-512dc36d8386971e699a96084011a41a.png"},99810:function(e,t,n){t.Z=n.p+"assets/images/explorer2-220e395fe0c10c00a265b0680a5b4caf.png"},90560:function(e,t,n){t.Z=n.p+"assets/images/fail-3cff6d9e6ddc62132897eb0d448f05fd.png"},63252:function(e,t,n){t.Z=n.p+"assets/images/faucet-28643b6212d66e81ef3e08cd6ef8f103.png"},4608:function(e,t,n){t.Z=n.p+"assets/images/multisig-3b43c4e56a57f1d9e062b902c0bce44f.png"},65339:function(e,t,n){t.Z=n.p+"assets/images/rotate1-b6c77c4d41e6e221a8fdca7911c84b60.png"},31805:function(e,t,n){t.Z=n.p+"assets/images/rotate2-daf567a808a1908ca855c52a8381d2dc.png"},48710:function(e,t,n){t.Z=n.p+"assets/images/rotate3-48bb45ccd92d3446ca45b73c90b12b1b.png"}}]);